TODO

= Deploy Shop Application

include::_attributes.adoc[]

{user} 

[.lines_7]
[.console-input]
[source,sh,subs="+macros,+attributes"]
----
oc login -u {user}  -p openshift {cluster_api}
----

== Clone repo

We have a GitHub repository for this demo. As part of the demo, you will have to do some changes and commits. So it is important that you fork the repository and clone it in your local.

[.lines_7]
[.console-input]
[source,input,subs="+macros,+attributes"]
----
git clone https://github.com/your_user/cloud-native-deployment-strategies
cd cloud-native-deployment-strategies
git checkout -b release
git push origin release
----

== Deploy Shop Stage and Prod

[source,yaml]
----
include::example$argocd/applicationset-shop.yaml[]
----
[.lines_7]
[.console-input]
[source,input,subs="+macros,+attributes"]
----
oc apply -f applicationset-shop.yaml -n openshift-gitops 
----


== Test Shop Stage
[.lines_7]
[.console-input]
[source,input,subs="+macros,+attributes"]
----
curl "$(oc get routes products-umbrella-online -n {user}-stage --template='https://{{.spec.host}}')/products"
curl "$(oc get routes products-umbrella-offline -n {user}-stage --template='https://{{.spec.host}}')/products"
----

== Test Shop Prod
[.lines_7]
[.console-input]
[source,input,subs="+macros,+attributes"]
----
curl "$(oc get routes products-umbrella-online -n {user}-prod --template='https://{{.spec.host}}')/products"
curl "$(oc get routes products-umbrella-offline -n {user}-prod --template='https://{{.spec.host}}')/products"
----